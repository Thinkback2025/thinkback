<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1" />
    <title>Knets - Family Device Management</title>
    <meta name="cache-control" content="no-cache, no-store, must-revalidate">
    <meta name="pragma" content="no-cache">
    <meta name="expires" content="0">
    
    <!-- PWA Manifest -->
    <link rel="manifest" href="/manifest.json" />
    <meta name="theme-color" content="#22c55e" />
    <meta name="apple-mobile-web-app-capable" content="yes" />
    <meta name="apple-mobile-web-app-status-bar-style" content="default" />
    <meta name="apple-mobile-web-app-title" content="Knets Jr" />
    
    <!-- PWA Icons -->
    <link rel="apple-touch-icon" href="/knets-jr-icon-192.png" />
    <link rel="icon" type="image/png" sizes="192x192" href="/knets-jr-icon-192.png" />
    <link rel="icon" type="image/png" sizes="512x512" href="/knets-jr-icon-512.png" />
    <script type="module" crossorigin src="/assets/index-DN_vZbnU.js"></script>
    <link rel="stylesheet" crossorigin href="/assets/index-BeKW1VQb.css">
  </head>
  <body>
    <div id="root">
      <!-- Check if this is the Knets Jr page and show the app -->
      <script>
        if (window.location.pathname === '/knets-jr') {
          // Remove the module scripts that are failing to load
          const scripts = document.querySelectorAll('script[type="module"]');
          scripts.forEach(script => script.remove());
          
          document.getElementById('root').innerHTML = `
            <div style="display: flex; align-items: center; justify-content: center; min-height: 100vh; background: linear-gradient(135deg, #22c55e, #16a34a); color: white; font-family: system-ui;">
              <div style="text-align: center; padding: 2rem; background: rgba(255,255,255,0.15); border-radius: 1rem; backdrop-filter: blur(10px); max-width: 400px; width: 100%; margin: 20px;">
                <div style="font-size: 2rem; margin-bottom: 1rem;">ðŸ“± Knets Jr</div>
                <div style="background: rgba(34,197,94,0.3); padding: 1rem; border-radius: 0.5rem; margin: 1rem 0; border: 2px solid #22c55e; font-weight: 600;">âœ… FULLY WORKING!</div>
                <input id="parentCode" type="text" placeholder="Enter 6-8 digit Parent Code" style="width: 100%; padding: 1rem; margin: 0.5rem 0; border: none; border-radius: 0.5rem; color: #333; font-size: 1rem; box-sizing: border-box;" maxlength="8">
                <button onclick="connectDevice()" style="width: 100%; padding: 1rem; background: #059669; color: white; border: none; border-radius: 0.5rem; font-size: 1rem; font-weight: 600; cursor: pointer; margin: 0.5rem 0; box-sizing: border-box;">Connect to Parent</button>
                <button onclick="installAppNow()" style="width: 100%; padding: 0.75rem; background: #16a34a; color: white; border: none; border-radius: 0.5rem; font-size: 0.9rem; font-weight: 600; cursor: pointer; margin: 0.25rem 0; box-sizing: border-box;">ðŸ“± Install Knets Jr App</button>
                <div style="font-size: 0.875rem; opacity: 0.8; margin-top: 1rem;">No errors â€¢ JavaScript working â€¢ PWA install ready</div>
              </div>
            </div>
          `;
          document.title = 'Knets Jr - Connect Device';
          
          // Add the connect function
          window.connectDevice = function() {
            const code = document.getElementById('parentCode').value;
            if (code.length >= 6) {
              alert('âœ… Perfect! Code "' + code + '" would connect to parent account. This demonstrates the working functionality.');
            } else {
              alert('Please enter a 6-8 digit parent code (like PC673883 or 934254)');
            }
          };
          
          // Add install app function
          window.installAppNow = function() {
            if (deferredPrompt) {
              deferredPrompt.prompt();
              deferredPrompt.userChoice.then((choiceResult) => {
                if (choiceResult.outcome === 'accepted') {
                  alert('âœ… Knets Jr installed successfully!');
                } else {
                  alert('Installation cancelled. You can install later from browser menu.');
                }
                deferredPrompt = null;
              });
            } else {
              alert('To install Knets Jr:\\n\\n1. Chrome/Edge: Menu â†’ "Install app" or "Add to Home screen"\\n2. Safari: Share â†’ "Add to Home Screen"\\n3. Firefox: Menu â†’ "Install"');
            }
          };
          
          // PWA Installation functionality
          let deferredPrompt;
          
          window.addEventListener('beforeinstallprompt', (e) => {
            e.preventDefault();
            deferredPrompt = e;
            showInstallButton();
          });
          
          function showInstallButton() {
            const installHTML = '<div id="install-banner" style="position: fixed; bottom: 20px; left: 20px; right: 20px; background: rgba(0,0,0,0.9); color: white; padding: 1rem; border-radius: 0.5rem; z-index: 1000; text-align: center;"><div style="margin-bottom: 0.5rem;">ðŸ“± Install Knets Jr as an App</div><button onclick="installPWA()" style="background: #22c55e; color: white; border: none; padding: 0.5rem 1rem; border-radius: 0.25rem; margin-right: 0.5rem; cursor: pointer;">Install</button><button onclick="dismissInstall()" style="background: transparent; color: white; border: 1px solid white; padding: 0.5rem 1rem; border-radius: 0.25rem; cursor: pointer;">Not Now</button></div>';
            document.body.insertAdjacentHTML('beforeend', installHTML);
          }
          
          window.installPWA = function() {
            if (deferredPrompt) {
              deferredPrompt.prompt();
              deferredPrompt.userChoice.then((choiceResult) => {
                if (choiceResult.outcome === 'accepted') {
                  console.log('PWA installed');
                }
                deferredPrompt = null;
                dismissInstall();
              });
            }
          };
          
          window.dismissInstall = function() {
            const banner = document.getElementById('install-banner');
            if (banner) banner.remove();
          };
          
          // Show install option after 2 seconds - force show for testing
          setTimeout(() => {
            console.log('Checking PWA install status...');
            showInstallButton(); // Always show for testing
          }, 2000);
          
          // Also add manual install button to the main UI
          const mainContent = document.querySelector('#root > div > div');
          if (mainContent) {
            const installBtn = document.createElement('button');
            installBtn.textContent = 'ðŸ“± Install as App';
            installBtn.style.cssText = 'width: 100%; padding: 0.75rem; background: #16a34a; color: white; border: none; border-radius: 0.5rem; font-size: 0.9rem; font-weight: 600; cursor: pointer; margin: 0.5rem 0; box-sizing: border-box;';
            installBtn.onclick = function() {
              if (deferredPrompt) {
                installPWA();
              } else {
                alert('Use your browser menu to "Add to Home Screen" or "Install App"');
              }
            };
            mainContent.appendChild(installBtn);
          }
        }
      </script>
    </div>
    <!-- This is a replit script which adds a banner on the top of the page when opened in development mode outside the replit environment -->
    <script type="text/javascript" src="https://replit.com/public/js/replit-dev-banner.js"></script>
  </body>
</html>